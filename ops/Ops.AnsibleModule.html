<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/colorful.css">
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
    <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>AnsibleModule - Uxun's WIKI</title>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
  </head>

  <body>
    <div id="container" class="typo">
      
<div id="header">
  <div id="post-nav">
    <a href="/wiki/">Uxun's WIKI</a>
    &nbsp;&#187;&nbsp;
    <a href="/wiki/#../../../Dropbox/wiki/ops">../../../Dropbox/wiki/ops</a>
    &nbsp;&#187;&nbsp;AnsibleModule
    <span class="updated">Page Updated&nbsp;
    2019-08-20 13:00
    </span>
  </div>
</div>
<div class="clearfix"></div>
<div id="content">
  <h2 id="ansible-module">Ansible Module</h2>
<h3 id="1list">1.list</h3>
<table>
<thead>
<tr>
<th>setup</th>
<th>file</th>
<th>command</th>
<th>shell</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>script</strong></td>
<td><strong>cron</strong></td>
<td><strong>user and group</strong></td>
<td><strong>yum</strong></td>
</tr>
<tr>
<td><strong>yum_repository</strong></td>
<td><strong>replace</strong></td>
<td><strong>blockinfile</strong></td>
<td><strong>lineinfile</strong></td>
</tr>
<tr>
<td><strong>copy and fetch</strong></td>
<td><strong>find</strong></td>
<td><strong>service</strong></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="2module">2.Module</h3>
<p>ansible-doc -l: 所有支持的模块</p>
<p>ansible-doc -s fetch 模块详细信息</p>
<div class="hlcode"><pre><span class="n">ansible</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">-</span><span class="n">pattern</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">-</span><span class="n">f</span> <span class="n">forks</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">m</span> <span class="n">module_name</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">a</span> <span class="n">args</span><span class="p">]</span>
    <span class="o">-</span><span class="n">m</span> <span class="n">module</span><span class="err">：默认为</span><span class="n">command</span>
        <span class="o">-</span><span class="n">a</span>  <span class="n">args</span><span class="err">：指定模块的参数，</span><span class="n">key</span><span class="o">=</span><span class="n">value</span>
                <span class="err">注意：</span><span class="n">command</span><span class="err">模块要执行命令无须为</span><span class="n">key</span><span class="o">=</span><span class="n">value</span><span class="err">格式，而是直接给出要执行的命令即可</span>
</pre></div>


<p><strong>setup</strong></p>
<blockquote>
<p>setup 接受管理之前将自己的主机信息发送给管理者{jinjia2模板中调用的参数 无参数(收集远程主机的facts（远程主机的信息）)</p>
</blockquote>
<div class="hlcode"><pre><span class="cp"># setup 模块</span>
<span class="n">ansible</span> <span class="n">all</span> <span class="o">-</span><span class="n">m</span> <span class="n">setup</span>
<span class="cp"># filter</span>
<span class="n">ansible</span> <span class="n">one</span> <span class="o">-</span><span class="n">m</span> <span class="n">setup</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">filter</span><span class="o">=</span><span class="n">ansible_all_ipv4_addresses</span><span class="err">&#39;</span>
</pre></div>


<p><strong>file</strong></p>
<blockquote>
<p>state={touch|directory|link|present|absent}</p>
<p>src= 当state= hard | link src=指定链接源</p>
<p>recurse=yes 递归</p>
<p>path= mode= owner= group= state={directory|link|present|absent} </p>
</blockquote>
<div class="hlcode"><pre><span class="cp"># 文件</span>
<span class="n">file</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tet</span><span class="p">.</span><span class="n">conf</span> <span class="n">state</span><span class="o">=</span><span class="n">touch</span><span class="err">&#39;</span>

<span class="cp"># 目录</span>
<span class="n">file</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">test</span> <span class="n">mode</span><span class="o">=</span><span class="mo">0755</span> <span class="n">state</span><span class="o">=</span><span class="n">directory</span> <span class="n">owner</span><span class="o">=</span><span class="n">root</span> <span class="n">recurse</span><span class="o">=</span><span class="n">yes</span><span class="err">&#39;</span>

<span class="cp"># 将/etc/fstab文件链接到/tmp/fstab.symlink </span>
<span class="n">file</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">fstab</span><span class="p">.</span><span class="n">symlink</span> <span class="n">state</span><span class="o">=</span><span class="n">link</span> <span class="n">src</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span><span class="err">&#39;</span>
</pre></div>


<p><strong>command</strong></p>
<blockquote>
<p>command模块读取"&lt;，&gt;，|，；，&amp;" 这些符号</p>
<p>chdir：执行命令前进入目录</p>
<p>creates：指定文件存在时候，不执行命令</p>
<p>removes：指定文件不存在时候，不执行命令</p>
</blockquote>
<div class="hlcode"><pre><span class="n">command</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">chdir</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">kube</span><span class="o">/</span><span class="n">bin</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">nodes</span><span class="err">&#39;</span>

<span class="cp"># 文件不存在，执行命令</span>
<span class="n">command</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">creates</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">kube</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">kubectl</span> <span class="n">echo</span> <span class="n">on</span><span class="err">&#39;</span>
<span class="cp"># 文件不存在，不执行命令</span>
<span class="n">command</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">removes</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">kube</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">kubectl</span> <span class="n">echo</span> <span class="n">off</span><span class="err">&#39;</span>
</pre></div>


<p><strong>shell</strong></p>
<blockquote>
<p>通过远程主机的shell 处理</p>
<p>executable：指定shell</p>
</blockquote>
<div class="hlcode"><pre><span class="n">shell</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">echo</span> <span class="n">geentoo</span> <span class="o">|</span><span class="n">passwd</span> <span class="o">--</span><span class="n">stdin</span> <span class="n">geentoo</span><span class="err">&#39;</span>
</pre></div>


<p><strong>script</strong></p>
<blockquote>
<p>脚本为deploy节点，无需其他节点</p>
<p>create：文件存在，不执行脚本</p>
<p>removes：文件不存在，不执行脚本</p>
</blockquote>
<div class="hlcode"><pre><span class="n">vim</span> <span class="n">dateTest</span><span class="p">.</span><span class="n">sh</span>
<span class="cp">#!/bin/bash</span>
<span class="n">echo</span> <span class="err">$</span><span class="p">(</span><span class="n">date</span> <span class="o">+</span><span class="s">&quot;%F %T&quot;</span><span class="p">)</span><span class="o">&gt;/</span><span class="n">tmp</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span>

<span class="n">script</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">dateTest</span><span class="p">.</span><span class="n">sh</span><span class="err">&#39;</span>
</pre></div>


<p><strong>cron</strong></p>
<blockquote>
<p>'minute= hour= day= month= weekday= state='</p>
<p>name：计划任务中注释显示</p>
<p>job：任务中执行的命令或者脚本</p>
<p>user：默认root ，指定执行用户</p>
<p>special_time：该参数后执行job{reboot|yearly|monthly|weekly|daily|hourly}</p>
<p>disabled=yes：注释任务</p>
</blockquote>
<div class="hlcode"><pre><span class="cp"># 创建任务</span>
<span class="n">cron</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;crontab dat test&quot;</span> <span class="n">minute</span><span class="o">=</span><span class="mi">1</span> <span class="n">hour</span><span class="o">=</span><span class="mi">1</span> <span class="n">day</span><span class="o">=</span><span class="err">*/</span><span class="mi">3</span> <span class="n">job</span><span class="o">=</span><span class="s">&quot;echo test&quot;</span><span class="err">&#39;</span>
<span class="cp">#Ansible: crontab dat test</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="err">*/</span><span class="mi">3</span> <span class="o">*</span> <span class="o">*</span> <span class="n">echo</span> <span class="n">test</span>

<span class="cp"># 注释 </span>
<span class="n">cron</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;crontab dat test&quot;</span> <span class="n">minute</span><span class="o">=</span><span class="mi">1</span> <span class="n">hour</span><span class="o">=</span><span class="mi">1</span> <span class="n">day</span><span class="o">=</span><span class="err">*/</span><span class="mi">3</span> <span class="n">job</span><span class="o">=</span><span class="s">&quot;echo test&quot;</span> <span class="n">disabled</span><span class="o">=</span><span class="n">yes</span><span class="err">&#39;</span>
<span class="cp">#Ansible: crontab dat test</span>
<span class="cp">#1 1 */3 * * echo test</span>

<span class="cp"># 开机后任务</span>
<span class="n">cron</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;crontab dat test&quot;</span> <span class="n">special_time</span><span class="o">=</span><span class="n">reboot</span> <span class="n">job</span><span class="o">=</span><span class="s">&quot;echo test&quot;</span><span class="err">&#39;</span>
<span class="cp">#Ansible: crontab dat test</span>
<span class="err">@</span><span class="n">reboot</span> <span class="n">echo</span> <span class="n">test</span>
</pre></div>


<p><strong>user and group</strong></p>
<blockquote>
<p>group：基本组</p>
<p>groups：附加组</p>
<p>append=yes：追加附加组到现有附加组</p>
<p>expires：用户过期时间</p>
<p>password：明文加密字符串才可识别</p>
<p>generate_ssh_key：用户家目录生成密钥对</p>
<p>ssh_key_file：自定义路径</p>
<p>ssh_key_passphrase：密钥password</p>
<p>ssh_key_type：密钥类型</p>
</blockquote>
<div class="hlcode"><pre><span class="cp"># delete user and home </span>
<span class="n">user</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="n">uxun</span> <span class="n">state</span><span class="o">=</span><span class="n">absent</span> <span class="n">remove</span><span class="o">=</span><span class="n">yes</span><span class="err">&#39;</span>

<span class="cp"># add group </span>
<span class="n">user</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="n">uxun</span> <span class="n">group</span><span class="o">=</span><span class="n">xxx</span><span class="err">&#39;</span>

<span class="cp"># append groups </span>
<span class="n">user</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="n">uxun</span> <span class="n">groups</span><span class="o">=</span><span class="n">hhhhh</span> <span class="n">append</span><span class="o">=</span><span class="n">yes</span><span class="err">&#39;</span>

<span class="cp"># 用户过期时间通过 获取对应过期时间 `date -d 2030-12-22 +%s`的unix时间戳</span>
<span class="n">user</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="n">uxun</span> <span class="n">expires</span><span class="o">=</span><span class="mi">1924099200</span> <span class="n">generate_ssh_key</span><span class="o">=</span><span class="n">yes</span> <span class="n">ssh_key_file</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">id_rsa_uxun</span><span class="err">&#39;</span>

<span class="cp"># 用户组</span>
<span class="n">group</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="n">xxx</span> <span class="n">git</span><span class="o">=</span><span class="mi">1008</span><span class="err">&#39;</span>
</pre></div>


<p><strong>yum and <a href="https://docs.ansible.com/ansible/latest/modules/yum_repository_module.html#examples">yum_repository</a></strong></p>
<blockquote>
<p>yum模块 state={present|latest|absent}</p>
<p>disable_gpg_check：默认no，用于禁用对rpm包的公钥gpg验证。 yes表示禁用验证，不验证直接安装</p>
<p>enablerepo：用于临时启用yum源</p>
<p>disablerepo：用于临时禁用yum源</p>
<p>yum_repository模块</p>
<p>管理yum仓库</p>
<p>file：name.repo 文件名</p>
<p>name：name.repo 文件名vs 中括号[name] 字段</p>
<p>baseurl：yum仓库的baseurl</p>
<p>description：name.repo 中name字段</p>
<p>enabled=yes：默认yes，激活yum源</p>
<p>gpgcheck=no：默认no，不启用包验证</p>
<p>gpgcakey=yes：gpgcheck=yes，需要此参数开启验证</p>
</blockquote>
<div class="hlcode"><pre><span class="cp"># 临时启用yum源</span>
<span class="n">yum</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="n">kernel</span><span class="o">-</span><span class="n">lt</span> <span class="n">enablerepo</span><span class="o">=</span><span class="n">elrepo</span><span class="o">-</span><span class="n">kernel</span><span class="err">&#39;</span>
<span class="cp"># 临时禁用yum源</span>
<span class="n">yum</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="n">kernel</span><span class="o">-</span><span class="n">lt</span> <span class="n">disable_gpg_check</span><span class="o">=</span><span class="n">yes</span> <span class="n">disablerepo</span><span class="o">=</span><span class="n">elrepo</span><span class="o">-</span><span class="n">kernel</span><span class="err">&#39;</span>

<span class="n">yum_repository</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">file</span><span class="o">=</span><span class="n">aliyun</span> <span class="n">name</span><span class="o">=</span><span class="n">aliyun</span> <span class="n">description</span><span class="o">=</span><span class="s">&quot;aliyun-epel&quot;</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//mirrors.aliyun.com/epel/7/$basearch enabled=yes gpgcheck=no&#39;</span>
</pre></div>


<p><strong>replace</strong></p>
<blockquote>
<p>正则匹配文件中的字符串，所有匹配都被替换</p>
<p>replace：最终需要替换成的字符串</p>
<p>backup：操作前对文件备份</p>
</blockquote>
<div class="hlcode"><pre><span class="cp"># 替换字符串</span>
<span class="n">replace</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span> <span class="n">regexp</span><span class="o">=</span><span class="s">&quot;127.0.0.1&quot;</span> <span class="n">replace</span><span class="o">=</span><span class="s">&quot;192.168.1.116&quot;</span> <span class="n">backup</span><span class="o">=</span><span class="n">yes</span><span class="err">&#39;</span>
</pre></div>


<p><strong>blockinfile</strong></p>
<blockquote>
<p>文件内容追加内容</p>
<p>insertbefore=BOF：追加文件开头</p>
<p>insertafter=EOF：追加结尾</p>
<p>create=yes：文件存在，创建</p>
<p>backup=yes：修改之前，备份</p>
</blockquote>
<div class="hlcode"><pre><span class="cp"># 追加文件内容</span>
<span class="n">blockinfile</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span> <span class="n">block</span><span class="o">=</span><span class="s">&quot;systemctl start mysql</span><span class="se">\n</span><span class="s">systemctl start httpd&quot;</span> <span class="n">marker</span><span class="o">=</span><span class="s">&quot;#{mark} start&quot;</span><span class="err">&#39;</span>

<span class="n">cat</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span>
<span class="cp">#BEGIN start</span>
<span class="n">systemctl</span> <span class="n">start</span> <span class="n">mysql</span>
<span class="n">systemctl</span> <span class="n">start</span> <span class="n">httpd</span>
<span class="cp">#END start</span>

<span class="cp"># block=&quot;&quot; 直接删除文本块</span>
<span class="n">blockinfile</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span> <span class="n">block</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="n">marker</span><span class="o">=</span><span class="s">&quot;#{mark} start&quot;</span><span class="err">&#39;</span>

<span class="cp"># 文件开头插入文本块</span>
<span class="n">blockinfile</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span> <span class="n">block</span><span class="o">=</span><span class="s">&quot;systemctl start mysql</span><span class="se">\n</span><span class="s">systemctl start httpd&quot;</span> <span class="n">marker</span><span class="o">=</span><span class="s">&quot;#{mark} start&quot;</span> <span class="n">insertbefore</span><span class="o">=</span><span class="n">BOF</span><span class="err">&#39;</span>

<span class="cp"># 文件结尾插入文本块</span>
<span class="n">blockinfile</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span> <span class="n">block</span><span class="o">=</span><span class="s">&quot;systemctl start mysql</span><span class="se">\n</span><span class="s">systemctl start httpd&quot;</span> <span class="n">marker</span><span class="o">=</span><span class="s">&quot;#{mark} start&quot;</span> <span class="n">insertafter</span><span class="o">=</span><span class="n">EOF</span><span class="err">&#39;</span>

<span class="cp"># 在#!/bin/bash开头的行之后追加</span>
<span class="n">blockinfile</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc</span><span class="p">.</span><span class="n">local</span> <span class="n">block</span><span class="o">=</span><span class="s">&quot;####blockinfile test####&quot;</span> <span class="n">marker</span><span class="o">=</span><span class="s">&quot;#{mark} start&quot;</span> <span class="n">insertafter</span><span class="o">=</span><span class="s">&quot;^#!/bin/bash&quot;</span><span class="err">&#39;</span>
</pre></div>


<p><strong>lineinfile</strong></p>
<blockquote>
<p>line：此参数指定文本内容</p>
<p>regexp：正则匹配对应的行</p>
</blockquote>
<div class="hlcode"><pre><span class="cp"># 替换 /etc/hosts 中的127.0.0.1匹配的行文本，只有最后一个匹配正则行才被替换</span>
<span class="n">lineinfile</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span> <span class="n">regexp</span><span class="o">=</span><span class="s">&quot;^127.0.0.1&quot;</span> <span class="n">line</span><span class="o">=</span><span class="s">&quot;192.168.1.116&quot;</span><span class="err">&#39;</span>

<span class="cp"># backrefs=yes 无匹配则不替换，</span>
<span class="n">lineinfile</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">path</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span> <span class="n">regexp</span><span class="o">=</span><span class="s">&quot;^127.0.0.1&quot;</span> <span class="n">line</span><span class="o">=</span><span class="s">&quot;192.168.1.116&quot;</span> <span class="n">backrefs</span><span class="o">=</span><span class="n">yes</span><span class="err">&#39;</span>
</pre></div>


<p><strong>copy and fetch</strong></p>
<blockquote>
<p>copy Local to the remote</p>
<p>fetch：The remote host to the local</p>
</blockquote>
<div class="hlcode"><pre><span class="cp"># copy 远端主机文件到本机</span>
<span class="n">fetch</span> <span class="o">-</span><span class="n">a</span> <span class="s">&quot;src=/etc/hosts dest=/local/data/&quot;</span>

<span class="cp"># copy localhost file to Hosts</span>
<span class="n">copy</span> <span class="o">-</span><span class="n">a</span> <span class="s">&quot;src= dest= mode= owner= group= backup=文件不同备份 force=yes|no文件是否覆盖 &quot;</span>
<span class="cp"># 指定内容直接生成文件</span>
<span class="n">copy</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">content</span><span class="o">=</span><span class="s">&quot;sssssssssssssssssssssssssssssssssssssssssss&quot;</span> <span class="n">dest</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sss</span><span class="p">.</span><span class="n">back</span><span class="err">&#39;</span>

<span class="cp"># force=yes 同名文件不同直接覆盖 </span>
<span class="n">copy</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">src</span><span class="o">=/</span><span class="n">data</span><span class="o">/</span><span class="n">cluster</span><span class="o">/</span><span class="n">web</span> <span class="n">dest</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span> <span class="n">force</span><span class="o">=</span><span class="n">no</span><span class="err">&#39;</span>
<span class="cp"># backup=yes 同名文件备份</span>
<span class="n">copy</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">src</span><span class="o">=/</span><span class="n">data</span><span class="o">/</span><span class="n">cluster</span><span class="o">/</span><span class="n">conf</span> <span class="n">dest</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span> <span class="n">backup</span><span class="o">=</span><span class="n">yes</span><span class="err">&#39;</span>
</pre></div>


<p><strong>find</strong></p>
<blockquote>
<p>size: t g m k b </p>
<p>age: s() m() h() d() w()</p>
<p>age_stamp: atime ctime mtime</p>
<p>recurse=yes 递归</p>
<p>hidden=yes 隐藏文件</p>
<p>file_type: any directory file link</p>
<p>patterns: 文件名匹配</p>
<p>use_regex=yes: python 正则解析</p>
<p>contains: 文件内容匹配</p>
</blockquote>
<div class="hlcode"><pre><span class="cp"># e.g</span>
<span class="n">find</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">paths</span><span class="o">=/</span><span class="n">data</span><span class="o">/</span><span class="n">cluster</span> <span class="n">patterns</span><span class="o">=</span><span class="s">&quot;.*\.sh&quot;</span> <span class="n">age</span><span class="o">=-</span><span class="mi">4</span><span class="n">d</span> <span class="n">recurse</span><span class="o">=</span><span class="n">yes</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="n">m</span><span class="err">&#39;</span>
</pre></div>


<p><strong>service</strong></p>
<div class="hlcode"><pre><span class="cp"># service -a &#39;name= state={started|stopped|restarted} enable={yes|no}&#39;</span>
<span class="n">service</span> <span class="o">-</span><span class="n">a</span> <span class="err">&#39;</span><span class="n">name</span><span class="o">=</span><span class="n">nginx</span> <span class="n">state</span><span class="o">=</span><span class="n">stopped</span> <span class="n">enabled</span><span class="o">=</span><span class="n">no</span><span class="err">&#39;</span>
<span class="n">name</span><span class="o">=</span> <span class="n">state</span><span class="o">=</span><span class="p">{</span><span class="n">started</span><span class="o">|</span><span class="n">stopped</span><span class="o">|</span><span class="n">restarted</span><span class="p">}</span> <span class="n">enable</span><span class="o">=</span><span class="p">{</span><span class="n">yes</span><span class="o">|</span><span class="n">no</span><span class="p">}</span>
</pre></div>
  
</div>
    </div>
    <div id="footer">
      <div class="footer-left">
        <p>
        Copyright © 2019 Uxun.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
        Theme by <a href="https://github.com/tankywoo/yasimple_x2" target="_blank">YASimple_X2</a>.
        </p>
      </div> <!-- end footer-left -->
      <div class="footer-right">
        <p>Page Updated 2019-09-11 10:06:50</p>
      </div> <!-- end footer-right -->
    </div>

    
    

  </body>
</html>